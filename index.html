<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chat Tributo</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="page">
    <h1 id="header">Chat Tributo</h1>

    <main id="chat-container" role="application" aria-label="Chat Tributo">
      <div id="messages" aria-live="polite"></div>

      <div id="input-area">
        <input id="userInput" type="text" placeholder="Type your message..." aria-label="Message input" />
        <button id="sendButton" aria-label="Send message">Send</button>
      </div>
    </main>
  </div>

<script>
  //const ENDPOINT = "https://enough-blatantly-whale.ngrok-free.app/chat";
  const ENDPOINT = "";

  const messagesDiv = document.getElementById('messages');
  const inputField = document.getElementById('userInput');
  const sendButton = document.getElementById('sendButton');

  function addMessage(text, who = 'bot') {
    const d = document.createElement('div');
    d.className = 'message ' + (who === 'user' ? 'user' : 'bot');
    d.textContent = text;
    messagesDiv.appendChild(d);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  }

  async function sendMessage() {
    const message = inputField.value.trim();
    if (!message) return;
    addMessage(message, 'user');
    inputField.value = '';
    try {
      const res = await fetch(ENDPOINT, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message })
      });
      if (!res.ok) {
        addMessage(`Error: ${res.status}`, 'bot');
        return;
      }
      const json = await res.json().catch(() => null);
      const reply = (json && (json.reply || json.message || json.text)) || (json ? JSON.stringify(json) : 'No JSON reply');
      addMessage(reply, 'bot');
    } catch (err) {
      addMessage("Error sending message: " + err.message, 'bot');
    }
  }

  sendButton.addEventListener('click', sendMessage);
  inputField.addEventListener('keypress', (e) => { if (e.key === 'Enter') sendMessage(); });
</script>
</body>
</html>
